为了防止用户在下单过程中同一订单被多次支付，
比如我们在2台手机同时登录美团，第一台先调用支付宝付款，在界面等待，
第二台手机调起微信支付，2台手机同时付款，会发现都会支付成功，过一会就有一笔支付宝或者微信退款请求

## ✅ 解决思路

### 1. 业务层面
- **唯一订单号（OrderNo）**  
  每笔业务生成唯一订单号，保证支付请求和订单绑定。  
- **订单状态机控制**  
  订单状态：`待支付 → 已支付 → 已取消`。  
  在发起支付或接收回调时校验状态，避免二次支付。  
- **前端限制**  
  - 按钮置灰、防抖处理。  
  - 加载中提示，避免重复点击。
  
### 2. 技术层面
- **幂等控制**  
  - 通过 Redis 分布式锁、唯一请求号防止多次处理。   

- **支付回调幂等**
  - 支付渠道可能多次回调，必须做幂等处理。

- **事务控制**
  - 在更新订单状态和记录支付流水时，使用数据库事务保证一致性。

### 3. 系统兜底
- **退款机制**：如果发生重复支付，支持自动/人工退款。
- **对账机制**：定期与支付渠道对账，发现异常交易并补救。 