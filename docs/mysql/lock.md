InnoDB å­˜å‚¨å¼•æ“Žä¸ºäº†å®žçŽ°é«˜å¹¶å‘äº‹åŠ¡å¤„ç†ï¼Œé‡‡ç”¨äº†å¤šç§é”æœºåˆ¶ï¼ŒåŒ…æ‹¬è¡Œé”ã€é—´éš™é”ã€æ„å‘é”ã€è¡¨é”ã€å…ƒæ•°æ®é”ç­‰ã€‚æœ¬æ–‡æ¢³ç†å„ç§é”çš„ç±»åž‹ã€è§¦å‘æ¡ä»¶åŠåº”ç”¨åœºæ™¯ã€‚

## ðŸ”’ 1. è¡Œé”ï¼ˆRecord Lockï¼‰

- **å®šä¹‰**ï¼šé”å®šæŸä¸€æ¡å·²å­˜åœ¨çš„è®°å½•ã€‚
- **è§¦å‘æ¡ä»¶**ï¼š
  - ç²¾ç¡®åŒ¹é…ç´¢å¼•åˆ—çš„ DML/SELECT FOR UPDATE è¯­å¥ã€‚
- **ç¤ºä¾‹**ï¼š

```sql
SELECT * FROM users WHERE id = 5 FOR UPDATE;
UPDATE users SET name = 'aaa' WHERE id = 5;
```
- è¯´æ˜Žï¼šå…¶ä»–äº‹åŠ¡ä¸èƒ½ä¿®æ”¹è¿™æ¡è®°å½•ï¼Œç›´åˆ°å½“å‰äº‹åŠ¡æäº¤æˆ–å›žæ»šã€‚

## ðŸ”’ 2. é—´éš™é”ï¼ˆGap Lockï¼‰
- **å®šä¹‰**ï¼šé”å®šä¸¤æ¡ç´¢å¼•è®°å½•ä¹‹é—´çš„é—´éš™ï¼Œä¸ºäº†é˜²æ­¢å¹»è¯»è€Œå¼•å…¥çš„é”ã€‚å®ƒé”ä½çš„æ˜¯ **ç´¢å¼•è®°å½•ä¹‹é—´çš„é—´éš™**ï¼Œå¹¶ä¸ä¼šé”å®šå…·ä½“çš„è®°å½•ã€‚
- **è§¦å‘æ¡ä»¶**ï¼š
	- äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º REPEATABLE READã€‚
	- ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ä¸”å¸¦ç´¢å¼•ï¼ˆä¸æ˜¯ä¸»é”®ç­‰å€¼ï¼‰ã€‚
	- è¯­å¥ä¸º SELECT ... FOR UPDATEã€UPDATE ç­‰ã€‚

- **ç¤ºä¾‹**ï¼š
```sql
SELECT * FROM users WHERE id > 5 AND id < 10 FOR UPDATE;
DELETE FROM users WHERE id > 5 AND id < 10;
```
- è¯´æ˜Žï¼šä¼šé”ä½ id åœ¨ (5,10) ä¹‹é—´çš„ç©ºéš™ï¼Œé˜²æ­¢æ’å…¥ id=7 ç­‰è®°å½•ã€‚
## ðŸ”’ 3. Next-Key é”ï¼ˆRecord + Gapï¼‰
- **å®šä¹‰**ï¼šè¡Œé” + é—´éš™é”ï¼Œé”ä½è®°å½•æœ¬èº«åŠå…¶å‰æ–¹é—´éš™ã€‚
- **è§¦å‘æ¡ä»¶**ï¼š
	- é»˜è®¤ä½¿ç”¨ REPEATABLE READ éš”ç¦»çº§åˆ«ã€‚

	- å¯¹ç´¢å¼•åˆ—è¿›è¡ŒèŒƒå›´æˆ–ç­‰å€¼æŸ¥è¯¢ã€‚

	- ä½¿ç”¨ SELECT ... FOR UPDATEã€UPDATEã€DELETEã€‚
- **ç¤ºä¾‹**ï¼š
```sql
SELECT * FROM users WHERE id > 5 AND id < 10 FOR UPDATE;
```
- è¯´æ˜Žï¼šä¼šé”ä½ id åœ¨ (5,10) ä¹‹é—´çš„ç©ºéš™ï¼Œé˜²æ­¢æ’å…¥ id=7 ç­‰è®°å½•ã€‚